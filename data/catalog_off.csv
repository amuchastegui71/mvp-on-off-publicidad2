import pandas as pd
import numpy as np
from pathlib import Path

off_rows = [
    ["TV",          "Telefe",          "Prime Time 30s",    2200000, 130, np.nan, np.nan, 42000, 4.5, "OFF"],
    ["TV",          "Canal 13",        "Noticiero 20s",     1800000, 120, np.nan, np.nan, 39000, 4.4, "OFF"],
    ["Radio",       "Radio Mitre",     "Mañana 30s",         800000,  85, np.nan, np.nan, 14000, 4.3, "OFF"],
    ["Radio",       "La 100",          "Drive 30s",          700000,  80, np.nan, np.nan, 13500, 3.7, "OFF"],
    ["Radio",       "Urbana Play",     "Tarde 30s",          600000,  75, np.nan, np.nan, 12000, 4.1, "OFF"],
    ["Vía Pública", "Grupo Atlántida", "Cartel 8x3",         450000, np.nan, np.nan, np.nan, 18000, 4.0, "OFF"],
    ["Vía Pública", "Flix Media",      "LED Urbano",         400000, np.nan, np.nan, np.nan, 16500, 3.9, "OFF"],
    ["Cines",       "FilmSuez",        "Trailer 30s",        220000, np.nan, np.nan, np.nan, 19000, 3.4, "OFF"],
    ["Cines",       "Flix Media",      "Spot 15s",           200000, np.nan, np.nan, np.nan, 17500, 2.3, "OFF"],
    ["Vía Pública", "Publinet",        "Pantalla Gigante",   480000, np.nan, np.nan, np.nan, 20000, 1.1, "OFF"]
]

cols = ["medium","vendor","format","impressions","grps","clicks","views","cost","rating","medium_type"]
off_df = pd.DataFrame(off_rows, columns=cols)

# OFF solo CPM (no CPC/CPL/CPA)
off_df["CPM"] = np.where(off_df["impressions"].gt(0), (off_df["cost"] / off_df["impressions"]) * 1000, np.nan)
off_df["CPC"] = np.nan
off_df["CPL"] = np.nan
off_df["CPA"] = np.nan

off_df["CPM"] = off_df["CPM"].astype(float).round(2)

Path("data").mkdir(exist_ok=True)
off_df.to_csv("data/catalog_off.csv", index=False)
print("✅ Inventario OFF generado: data/catalog_off.csv")
print(off_df)
